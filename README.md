# Проект Message Passing System

## Обзор

Проект представляет собой систему передачи сообщений между процессами в Windows, реализованную двумя способами:

1. **Нативная реализация с использованием WinAPI**
   - Использует механизмы ядра Windows: мьютексы, семафоры и события
   - Основана на разделяемой памяти через memory-mapped файлы
   - Реализует кольцевой буфер для сообщений

2. **Boost-реализация**
   - Использует библиотеку Boost.Interprocess
   - Реализует аналогичную функциональность с помощью Boost-примитивов
   - Более кроссплатформенное решение

## Требования

### Для нативной реализации (WinAPI)
- Windows 7 или выше
- CMake 3.14+
- Компилятор с поддержкой C++17 (MSVC, MinGW)

### Для Boost-реализации
- Boost 1.88+
- CMake 3.20+
- Компилятор с поддержкой C++20

## Структура проекта

### Основные файлы (WinAPI реализация)
- **Common.h** - общие структуры данных и константы
- **Receiver.cpp** - процесс-получатель сообщений
- **Sender.cpp** - процесс-отправитель сообщений
- **UnitTests.cpp** - тесты для функциональности буфера сообщений
- **CMakeLists.txt** - конфигурация сборки

## Сборка проекта

```
mkdir build
cd build
cmake ..
cmake --build . --config Release
```

## Запуск системы

### Для нативной реализации
1. Запустите Receiver:
   ```
   ./Receiver.exe
   ```
   - Введите имя файла (без расширения)
   - Укажите количество записей в буфере
   - Укажите количество отправителей

2. Команды в Receiver:
   - `read` - прочитать следующее сообщение
   - `exit` - завершить работу

3. Команды в Sender:
   - `send` - отправить новое сообщение
   - `exit` - завершить работу

## Особенности реализации

### Общие для обеих версий
- Кольцевой буфер фиксированного размера
- Ограничение длины сообщения (20 символов)
- Синхронизация между процессами
- Автоматическое создание файлов памяти

### Механизмы синхронизации
1. **WinAPI версия:**
   - Мьютекс (`FILE_MUTEX_NAME`)
   - Семафоры (`FREE_SLOTS_SEM_NAME`, `USED_SLOTS_SEM_NAME`)
   - Событие (`SENDERS_READY_EV_NAME`)

2. **Boost версия:**
   - Именованные мьютексы и семафоры
   - Управление памятью через `managed_mapped_file`
   - Межпроцессное взаимодействие через `boost::process`

## Тестирование

### Тестовые сценарии
- Проверка начального состояния буфера
- Запись и чтение одиночного сообщения
- Переполнение буфера
- Работа с длинными сообщениями (автоусечение)
- Имитация конкурентного доступа
- Поведение буфера при циклической перезаписи

## Особенности использования

1. **Размер буфера** - задается при запуске Receiver
2. **Максимальная длина сообщения** - 19 символов + нулевой терминатор
3. **Глобальные объекты синхронизации** - создаются с префиксом "Global\\"
4. **Автоматическое завершение** - при выходе из Receiver все Sender процессы завершаются

## Пример работы

### Сессия Receiver
```
Enter file name (without extension): data
Enter number of records: 5
Enter number of Senders: 2
All Senders are ready.
Enter command (read/exit): read
Received: Hello World!
Enter command (read/exit): exit
```

### Сессия Sender
```
Enter command (send/exit): send
Enter message (up to 20 chars): Hello World!
Message sent.
Enter command (send/exit): exit
```
